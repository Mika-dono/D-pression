<!-- ==========================================
     LOGIN SCREEN
     ========================================== -->
<div *ngIf="!isLoggedIn" class="login-page">
  <div class="login-bg">
    <div class="login-gradient"></div>
    <div class="login-grid"></div>
    <div class="login-particles">
      <div class="particle" *ngFor="let i of [1,2,3,4,5,6,7,8]"></div>
    </div>
  </div>

  <div class="login-container">
    <div class="login-card">
      <div class="login-header">
        <div class="login-logo">
          <span class="logo-text">D-P</span>
        </div>
        <h1 class="login-title">Panel Admin</h1>
        <p class="login-subtitle">AccÃ¨s rÃ©servÃ© aux administrateurs</p>
      </div>

      <form (ngSubmit)="login()" class="login-form">
        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">ğŸ‘¤</span>
            Identifiant
          </label>
          <input 
            [(ngModel)]="credentials.username" 
            name="username"
            type="text" 
            placeholder="Entrez votre identifiant" 
            class="form-input"
            autocomplete="username"
          />
        </div>

        <div class="form-group">
          <label class="form-label">
            <span class="label-icon">ğŸ”’</span>
            Mot de passe
          </label>
          <input 
            [(ngModel)]="credentials.password" 
            name="password"
            type="password" 
            placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" 
            class="form-input"
            autocomplete="current-password"
          />
        </div>

        <div class="login-error" *ngIf="loginError">
          <span class="error-icon">âš ï¸</span>
          {{ loginError }}
        </div>

        <button type="submit" class="btn-login" [disabled]="isLoggingIn">
          <span *ngIf="!isLoggingIn">Connexion</span>
          <span *ngIf="isLoggingIn" class="loading-spinner"></span>
        </button>
      </form>

      <div class="login-footer">
        <p class="demo-hint">Demo: <span class="highlight">admin</span> / <span class="highlight">admin123</span></p>
      </div>
    </div>

    <div class="login-info">
      <div class="info-card">
        <span class="info-icon">ğŸ›¡ï¸</span>
        <p>Connexion sÃ©curisÃ©e</p>
      </div>
      <div class="info-card">
        <span class="info-icon">ğŸš€</span>
        <p>Interface premium</p>
      </div>
    </div>
  </div>
</div>

<!-- ==========================================
     ADMIN DASHBOARD
     ========================================== -->
<div *ngIf="isLoggedIn" class="admin-layout">
  <!-- Sidebar -->
  <aside class="admin-sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <span class="logo-icon">D-P</span>
        <span class="logo-text" *ngIf="!sidebarCollapsed">ADMIN</span>
      </div>
      <button class="btn-collapse" (click)="toggleSidebar()">
        {{ sidebarCollapsed ? 'â†’' : 'â†' }}
      </button>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section">
        <span class="nav-section-label" *ngIf="!sidebarCollapsed">NAVIGATION</span>
        <button 
          *ngFor="let section of navSections"
          (click)="switchSection(section.id)"
          class="nav-item"
          [class.active]="activeSection === section.id"
        >
          <span class="nav-icon">{{ section.icon }}</span>
          <span class="nav-label" *ngIf="!sidebarCollapsed">{{ section.label }}</span>
          <span class="nav-badge" *ngIf="section.badge && !sidebarCollapsed">{{ section.badge }}</span>
        </button>
      </div>
    </nav>

    <div class="sidebar-footer" *ngIf="!sidebarCollapsed">
      <a routerLink="/" class="btn-back-site">
        <span class="btn-icon">ğŸ </span>
        Retour au site
      </a>
      <button class="btn-logout" (click)="logout()">
        <span class="btn-icon">ğŸšª</span>
        DÃ©connexion
      </button>
    </div>
  </aside>

  <!-- Mobile Header -->
  <div class="mobile-header">
    <button class="btn-menu" (click)="toggleMobileMenu()">â˜°</button>
    <span class="mobile-logo">D-PRESSION Admin</span>
    <span class="mobile-user">{{ adminName }}</span>
  </div>

  <!-- Mobile Menu Overlay -->
  <div class="mobile-menu-overlay" [class.active]="showMobileMenu" (click)="toggleMobileMenu()"></div>
  <div class="mobile-menu" [class.active]="showMobileMenu">
    <button 
      *ngFor="let section of navSections"
      (click)="switchSection(section.id)"
      class="mobile-nav-item"
      [class.active]="activeSection === section.id"
    >
      <span class="nav-icon">{{ section.icon }}</span>
      {{ section.label }}
    </button>
    <button class="mobile-nav-item logout" (click)="logout()">
      <span class="nav-icon">ğŸšª</span>
      DÃ©connexion
    </button>
  </div>

  <!-- Main Content -->
  <main class="admin-main">
    <!-- Top Bar -->
    <header class="admin-topbar">
      <div class="topbar-left">
        <h1 class="page-title">{{ getSectionTitle() }}</h1>
        <p class="page-breadcrumb">Administration / {{ getSectionTitle() }}</p>
      </div>
      <div class="topbar-right">
        <div class="topbar-time">
          <span class="time-icon">ğŸ•</span>
          {{ currentTime | date:'HH:mm' }}
        </div>
        <div class="topbar-user">
          <div class="user-avatar">{{ adminName.charAt(0).toUpperCase() }}</div>
          <div class="user-info">
            <span class="user-greeting">{{ getGreeting() }}</span>
            <span class="user-name">{{ adminName }}</span>
          </div>
        </div>
      </div>
    </header>

    <div class="admin-content">
      <!-- ==========================================
           DASHBOARD SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'dashboard'" class="section-dashboard">
        <!-- Stats Grid -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">ğŸ“…</div>
            <div class="stat-content">
              <span class="stat-value">{{ dashboardStats.totalEvents }}</span>
              <span class="stat-label">Ã‰vÃ©nements</span>
            </div>
            <div class="stat-trend up">+12%</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ†</div>
            <div class="stat-content">
              <span class="stat-value">{{ dashboardStats.totalMatches }}</span>
              <span class="stat-label">Matchs</span>
            </div>
            <div class="stat-trend up">+8%</div>
          </div>
          <div class="stat-card highlight">
            <div class="stat-icon">ğŸ®</div>
            <div class="stat-content">
              <span class="stat-value">{{ dashboardStats.pendingScrims }}</span>
              <span class="stat-label">Scrims en attente</span>
            </div>
            <div class="stat-action" (click)="switchSection('scrims')">Voir â†’</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ’ª</div>
            <div class="stat-content">
              <span class="stat-value">{{ dashboardStats.weeklyTraining }}</span>
              <span class="stat-label">Jours planifiÃ©s</span>
            </div>
            <div class="stat-progress">
              <div class="progress-bar" [style.width]="(dashboardStats.weeklyTraining / 7 * 100) + '%'"></div>
            </div>
          </div>
        </div>

        <!-- Quick Actions & Upcoming -->
        <div class="dashboard-grid">
          <!-- Quick Actions -->
          <div class="admin-panel quick-actions">
            <div class="panel-header">
              <h3 class="panel-title">âš¡ Actions Rapides</h3>
            </div>
            <div class="actions-grid">
              <button class="action-btn" (click)="switchSection('events')">
                <span class="action-icon">â•</span>
                <span class="action-text">Nouvel Ã©vÃ©nement</span>
              </button>
              <button class="action-btn" (click)="switchSection('matches')">
                <span class="action-icon">ğŸ†</span>
                <span class="action-text">Programmer match</span>
              </button>
              <button class="action-btn" (click)="switchSection('weekly')">
                <span class="action-icon">ğŸ“…</span>
                <span class="action-text">Modifier planning</span>
              </button>
              <button class="action-btn" (click)="switchSection('scrims')">
                <span class="action-icon">ğŸ®</span>
                <span class="action-text">GÃ©rer scrims</span>
              </button>
            </div>
          </div>

          <!-- Upcoming Events -->
          <div class="admin-panel upcoming-events">
            <div class="panel-header">
              <h3 class="panel-title">ğŸ“† Prochains Ã‰vÃ©nements</h3>
              <button class="btn-see-all" (click)="switchSection('events')">Voir tout</button>
            </div>
            <div class="events-list">
              <div *ngIf="getUpcomingEvents().length === 0" class="empty-state-small">
                <span class="empty-icon">ğŸ“­</span>
                <p>Aucun Ã©vÃ©nement Ã  venir</p>
              </div>
              <div *ngFor="let event of getUpcomingEvents()" class="event-item">
                <div class="event-icon">{{ getEventIcon(event.type) }}</div>
                <div class="event-details">
                  <span class="event-title">{{ event.title }}</span>
                  <span class="event-date">{{ formatDate(event.date) }} â€¢ {{ formatTime(event.time) }}</span>
                </div>
                <span class="event-relative" *ngIf="getRelativeDate(event.date)">{{ getRelativeDate(event.date) }}</span>
              </div>
            </div>
          </div>

          <!-- Upcoming Matches -->
          <div class="admin-panel upcoming-matches">
            <div class="panel-header">
              <h3 class="panel-title">ğŸ† Prochains Matchs</h3>
              <button class="btn-see-all" (click)="switchSection('matches')">Voir tout</button>
            </div>
            <div class="matches-list">
              <div *ngIf="getUpcomingMatches().length === 0" class="empty-state-small">
                <span class="empty-icon">ğŸ¯</span>
                <p>Aucun match programmÃ©</p>
              </div>
              <div *ngFor="let match of getUpcomingMatches()" class="match-item">
                <div class="match-teams">
                  <span class="team team1">{{ match.team1 }}</span>
                  <span class="vs">VS</span>
                  <span class="team team2">{{ match.team2 }}</span>
                </div>
                <div class="match-info">
                  <span class="match-tournament">{{ match.tournament }}</span>
                  <span class="match-format">{{ match.format }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==========================================
           PLANNING SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'weekly'" class="section-planning">
        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">ğŸ“… Planning Hebdomadaire</h3>
            <span class="panel-badge">{{ Object.keys(schedule).length }} jours configurÃ©s</span>
          </div>
          
          <div class="schedule-grid">
            <div 
              *ngFor="let day of days"
              class="schedule-card"
              [class.selected]="selectedDay === day"
              [class.configured]="schedule[day]"
              (click)="fillDay(day)"
            >
              <div class="schedule-day">{{ day }}</div>
              <div class="schedule-time" *ngIf="schedule[day]">
                {{ schedule[day].start }} - {{ schedule[day].end }}
              </div>
              <div class="schedule-time empty" *ngIf="!schedule[day]">Non configurÃ©</div>
              <div class="schedule-desc" *ngIf="schedule[day]">{{ schedule[day].description }}</div>
            </div>
          </div>

          <div class="schedule-form">
            <h4 class="form-section-title">âœï¸ Modifier le planning</h4>
            <form (ngSubmit)="saveScheduleForm()" class="form-grid">
              <div class="form-group">
                <label class="form-label">Jour</label>
                <select [(ngModel)]="dayForm.day" name="day" class="form-select">
                  <option *ngFor="let day of days" [value]="day">{{ day }}</option>
                </select>
              </div>
              <div class="form-group">
                <label class="form-label">DÃ©but</label>
                <input [(ngModel)]="dayForm.start" name="start" type="time" class="form-input" />
              </div>
              <div class="form-group">
                <label class="form-label">Fin</label>
                <input [(ngModel)]="dayForm.end" name="end" type="time" class="form-input" />
              </div>
              <div class="form-group full-width">
                <label class="form-label">Description</label>
                <textarea [(ngModel)]="dayForm.description" name="description" class="form-textarea" placeholder="DÃ©tails de la session..."></textarea>
              </div>
              <div class="form-actions full-width">
                <button type="submit" class="btn-primary">ğŸ’¾ Sauvegarder</button>
              </div>
            </form>
          </div>
        </div>

        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">ğŸ¯ Objectifs de la Semaine</h3>
          </div>
          <form (ngSubmit)="saveObjectives()">
            <textarea 
              [(ngModel)]="weeklyObjectives" 
              name="objectives" 
              class="form-textarea large"
              placeholder="DÃ©finissez les objectifs de la semaine..."></textarea>
            <div class="form-actions">
              <button type="submit" class="btn-primary">ğŸ’¾ Enregistrer</button>
            </div>
          </form>
        </div>
      </div>

      <!-- ==========================================
           EVENTS SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'events'" class="section-events">
        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">â• CrÃ©er un Ã‰vÃ©nement</h3>
          </div>
          <form (ngSubmit)="addEvent()" class="form-grid">
            <div class="form-group">
              <label class="form-label">Titre *</label>
              <input [(ngModel)]="eventForm.title" name="title" type="text" class="form-input" placeholder="Nom de l'Ã©vÃ©nement" required />
            </div>
            <div class="form-group">
              <label class="form-label">Type</label>
              <select [(ngModel)]="eventForm.type" name="type" class="form-select">
                <option value="tournament">ğŸ† Tournoi</option>
                <option value="scrim">ğŸ® Scrim</option>
                <option value="training">ğŸ’ª EntraÃ®nement</option>
                <option value="meeting">ğŸ‘¥ RÃ©union</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Date *</label>
              <input [(ngModel)]="eventForm.date" name="date" type="date" class="form-input" required />
            </div>
            <div class="form-group">
              <label class="form-label">Heure</label>
              <input [(ngModel)]="eventForm.time" name="time" type="time" class="form-input" />
            </div>
            <div class="form-group full-width">
              <label class="form-label">Description</label>
              <textarea [(ngModel)]="eventForm.desc" name="desc" class="form-textarea" placeholder="DÃ©tails de l'Ã©vÃ©nement..."></textarea>
            </div>
            <div class="form-actions full-width">
              <button type="submit" class="btn-primary">â• CrÃ©er l'Ã©vÃ©nement</button>
            </div>
          </form>
        </div>

        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">ğŸ“‹ Ã‰vÃ©nements ProgrammÃ©s</h3>
            <span class="panel-badge">{{ getSortedEvents().length }} Ã©vÃ©nements</span>
          </div>
          <div class="events-table">
            <div *ngIf="getSortedEvents().length === 0" class="empty-state">
              <span class="empty-icon">ğŸ“­</span>
              <h4>Aucun Ã©vÃ©nement</h4>
              <p>CrÃ©ez votre premier Ã©vÃ©nement ci-dessus</p>
            </div>
            <div *ngFor="let event of getSortedEvents()" class="event-row">
              <div class="event-type-icon">{{ getEventIcon(event.type) }}</div>
              <div class="event-info">
                <span class="event-title">{{ event.title }}</span>
                <span class="event-type-badge">{{ labelEvent(event.type) }}</span>
              </div>
              <div class="event-datetime">
                <span class="event-date">{{ formatDate(event.date) }}</span>
                <span class="event-time">{{ formatTime(event.time) }}</span>
              </div>
              <div class="event-desc" *ngIf="event.description">{{ event.description }}</div>
              <div class="event-actions">
                <button class="btn-icon-action delete" (click)="deleteEvent(event.id)" title="Supprimer">ğŸ—‘ï¸</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==========================================
           MATCHES SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'matches'" class="section-matches">
        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">â• Programmer un Match</h3>
          </div>
          <form (ngSubmit)="addMatch()" class="form-grid">
            <div class="form-group">
              <label class="form-label">Tournoi / CompÃ©tition *</label>
              <input [(ngModel)]="matchForm.tournament" name="tournament" type="text" class="form-input" placeholder="Nom du tournoi" required />
            </div>
            <div class="form-group">
              <label class="form-label">Format</label>
              <select [(ngModel)]="matchForm.format" name="format" class="form-select">
                <option value="Bo1">Bo1</option>
                <option value="Bo3">Bo3</option>
                <option value="Bo5">Bo5</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Ã‰quipe 1 *</label>
              <input [(ngModel)]="matchForm.team1" name="team1" type="text" class="form-input" placeholder="Notre Ã©quipe" required />
            </div>
            <div class="form-group">
              <label class="form-label">Ã‰quipe 2 *</label>
              <input [(ngModel)]="matchForm.team2" name="team2" type="text" class="form-input" placeholder="Adversaire" required />
            </div>
            <div class="form-group">
              <label class="form-label">Date</label>
              <input [(ngModel)]="matchForm.date" name="date" type="date" class="form-input" />
            </div>
            <div class="form-group">
              <label class="form-label">Heure</label>
              <input [(ngModel)]="matchForm.time" name="time" type="time" class="form-input" />
            </div>
            <div class="form-actions full-width">
              <button type="submit" class="btn-primary">ğŸ† Ajouter le match</button>
            </div>
          </form>
        </div>

        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">ğŸ“‹ Matchs ProgrammÃ©s</h3>
            <span class="panel-badge">{{ getSortedMatches().length }} matchs</span>
          </div>
          <div class="matches-table">
            <div *ngIf="getSortedMatches().length === 0" class="empty-state">
              <span class="empty-icon">ğŸ†</span>
              <h4>Aucun match</h4>
              <p>Programmez votre premier match ci-dessus</p>
            </div>
            <div *ngFor="let match of getSortedMatches()" class="match-row" [class.hidden-match]="match.hidden">
              <div class="match-tournament">
                <span class="tournament-name">{{ match.tournament }}</span>
                <span class="match-format-badge">{{ match.format }}</span>
              </div>
              <div class="match-versus">
                <span class="team-name">{{ match.team1 }}</span>
                <span class="vs-badge">VS</span>
                <span class="team-name">{{ match.team2 }}</span>
              </div>
              <div class="match-datetime">
                <span class="match-date">{{ formatDate(match.date) }}</span>
                <span class="match-time">{{ formatTime(match.time) }}</span>
              </div>
              <div class="match-status" *ngIf="match.hidden">
                <span class="status-hidden">ğŸ‘ï¸ MasquÃ©</span>
              </div>
              <div class="match-actions">
                <button class="btn-icon-action" (click)="toggleMatch(match.id)" [title]="match.hidden ? 'Afficher' : 'Masquer'">
                  {{ match.hidden ? 'ğŸ‘ï¸' : 'ğŸ™ˆ' }}
                </button>
                <button class="btn-icon-action delete" (click)="deleteMatch(match.id)" title="Supprimer">ğŸ—‘ï¸</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==========================================
           SCRIMS SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'scrims'" class="section-scrims">
        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">ğŸ® Demandes de Scrims</h3>
            <span class="panel-badge">{{ getFilteredScrims().length }} demandes</span>
          </div>
          
          <div class="filter-tabs">
            <button 
              *ngFor="let filter of ['all', 'pending', 'accepted', 'rejected']"
              (click)="selectedFilter = filter"
              class="filter-tab"
              [class.active]="selectedFilter === filter"
            >
              {{ filter === 'all' ? 'Toutes' : filter === 'pending' ? 'â³ En attente' : filter === 'accepted' ? 'âœ… AcceptÃ©es' : 'âŒ RefusÃ©es' }}
            </button>
          </div>

          <div class="scrims-list">
            <div *ngIf="getFilteredScrims().length === 0" class="empty-state">
              <span class="empty-icon">ğŸ®</span>
              <h4>Aucune demande</h4>
              <p>Les demandes de scrims apparaÃ®tront ici</p>
            </div>
            <div *ngFor="let req of getFilteredScrims()" class="scrim-card">
              <div class="scrim-header">
                <div class="scrim-team">
                  <span class="team-avatar">{{ req.opponent?.charAt(0) || '?' }}</span>
                  <div class="team-info">
                    <span class="team-name">{{ req.opponent }}</span>
                    <span class="team-game">{{ req.game || 'Non prÃ©cisÃ©' }}</span>
                  </div>
                </div>
                <span class="scrim-status" [class]="badgeClass(req.status)">{{ labelStatus(req.status) }}</span>
              </div>
              <div class="scrim-details">
                <div class="detail-item">
                  <span class="detail-label">Jeu</span>
                  <span class="detail-value">{{ req.game || 'Non prÃ©cisÃ©' }}</span>
                </div>
                <div class="detail-item">
                  <span class="detail-label">Date souhaitÃ©e</span>
                  <span class="detail-value">{{ req.date ? formatDate(req.date) : 'Non prÃ©cisÃ©' }}</span>
                </div>
              </div>
              <p class="scrim-message" *ngIf="req.description">{{ req.description }}</p>
              <div class="scrim-actions" *ngIf="req.status === 'pending'">
                <button class="btn-accept" (click)="updateScrim(req.id, 'accepted')">âœ… Accepter</button>
                <button class="btn-reject" (click)="updateScrim(req.id, 'rejected')">âŒ Refuser</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==========================================
           ANALYTICS SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'analytics'" class="section-analytics">
        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">ğŸ“ˆ Analytiques</h3>
          </div>
          <div class="analytics-placeholder">
            <span class="placeholder-icon">ğŸ“Š</span>
            <h4>Analytiques Ã  venir</h4>
            <p>Cette section affichera les statistiques dÃ©taillÃ©es de votre Ã©quipe.</p>
          </div>
        </div>
      </div>

      <!-- ==========================================
           SETTINGS SECTION
           ========================================== -->
      <div *ngIf="activeSection === 'settings'" class="section-settings">
        <div class="admin-panel">
          <div class="panel-header">
            <h3 class="panel-title">âš™ï¸ ParamÃ¨tres</h3>
          </div>
          <div class="settings-grid">
            <div class="setting-card">
              <div class="setting-icon">ğŸ”</div>
              <div class="setting-content">
                <h4>SÃ©curitÃ©</h4>
                <p>GÃ©rer les accÃ¨s</p>
              </div>
            </div>
            <div class="setting-card">
              <div class="setting-icon">ğŸ¨</div>
              <div class="setting-content">
                <h4>Apparence</h4>
                <p>Personnaliser</p>
              </div>
            </div>
            <div class="setting-card">
              <div class="setting-icon">ğŸ””</div>
              <div class="setting-content">
                <h4>Notifications</h4>
                <p>Alertes</p>
              </div>
            </div>
            <div class="setting-card">
              <div class="setting-icon">ğŸ’¾</div>
              <div class="setting-content">
                <h4>DonnÃ©es</h4>
                <p>Exporter</p>
              </div>
            </div>
          </div>
          <div class="system-info">
            <h4>â„¹ï¸ SystÃ¨me</h4>
            <div class="info-grid">
              <div class="info-item"><span>App</span><span>D-PRESSION Admin v1.0</span></div>
              <div class="info-item"><span>Framework</span><span>Angular 21</span></div>
              <div class="info-item"><span>Backend</span><span>Spring Boot 3.2</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Toast Notification -->
<div class="toast-notification" [class.show]="showToastNotification" [class]="'toast-' + toastType">
  <span class="toast-icon">{{ toastType === 'success' ? 'âœ…' : toastType === 'error' ? 'âŒ' : 'âš ï¸' }}</span>
  <span class="toast-message">{{ toastMessage }}</span>
</div>
